import{e as E,o as l,i as p,w as g,a as s,m as r,v as u,f as c,c as o,h as T,F as m,n as A,t as d}from"./index-6e116a9b.js";import{_ as b}from"./Card.vue_vue_type_script_setup_true_lang-9eb08a8f.js";import{_ as C}from"./CopyMixin.vue_vue_type_script_setup_true_lang-e040a29a.js";class S{constructor(){this.SETTING_DEFAULT={length:8,lowercase:!0,uppercase:!0,numbers:!0,special:!0,avoidAmbiguous:!0,exclude:null,maxLength:256,minLength:6,uppercaseMinCount:1,lowercaseMinCount:1,numberMinCount:1,specialMinCount:1,UPPERCASE_REGEX:/([A-Z])/g,LOWERCASE_REGEX:/([a-z])/g,NUMBER_REGEX:/([\d])/g,SPECIAL_CHAR_REGEX:/([!@#$%^&*()\-=_+|~\\`{}[]:;<>,\.\?\/\'\";])/g,NON_REPEATING_CHAR_REGEX:/([\w\d\?\-])\1{2,}/g,AMBIGUOUS_CHARACTERS_REGEX:/[Il|]/g,DEFAULT_CHARACTERS:{LOWERCASE:"abcdefghijklmnopqrstuvwxyz",UPPERCASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",NUMBERS:"0123456789",SYMBOLS:"!@#$%^&*()-=_+|~\\`{}[]:;<>,.?/'\";",AMBIGUOUS_CHARACTERS:"Il|10O"}},this.setting=Object.assign(this.SETTING_DEFAULT,this.setting)}getDefaultSetting(){return this.SETTING_DEFAULT}generate(e=this.SETTING_DEFAULT){this.setting=Object.assign(this.SETTING_DEFAULT,e);let n="",t=this.generateCharacters(this);return n=this.executeGenerating(t),n}isStrongEnough(e){let n=e.match(this.SETTING_DEFAULT.UPPERCASE_REGEX),t=e.match(this.SETTING_DEFAULT.LOWERCASE_REGEX),i=e.match(this.SETTING_DEFAULT.NUMBER_REGEX),a=e.match(this.SETTING_DEFAULT.SPECIAL_CHAR_REGEX),_=e.match(this.SETTING_DEFAULT.NON_REPEATING_CHAR_REGEX);return e.length>=this.SETTING_DEFAULT.minLength&&!_&&n&&n.length>=this.SETTING_DEFAULT.uppercaseMinCount&&t&&t.length>=this.SETTING_DEFAULT.lowercaseMinCount&&i&&i.length>=this.SETTING_DEFAULT.numberMinCount&&a&&a.length>=this.SETTING_DEFAULT.specialMinCount}generateCharacters(){let e="";return this.setting.lowercase&&(e+=this.SETTING_DEFAULT.DEFAULT_CHARACTERS.LOWERCASE),this.setting.uppercase&&(e+=this.SETTING_DEFAULT.DEFAULT_CHARACTERS.UPPERCASE),this.setting.numbers&&(e+=this.SETTING_DEFAULT.DEFAULT_CHARACTERS.NUMBERS),this.setting.special&&(e+=this.SETTING_DEFAULT.DEFAULT_CHARACTERS.SYMBOLS),this.setting.avoidAmbiguous&&(e=e.replace(this.SETTING_DEFAULT.AMBIGUOUS_CHARACTERS_REGEX,"")),this.setting.exclude&&this.setting.exclude.length>0&&(this.setting.exclude=Array.isArray(this.setting.exclude)?this.setting.exclude:[this.setting.exclude],e=e.replace(new RegExp(this.setting.exclude.join("|"),"g"),"")),e}executeGenerating(e){let n="",t=e.length;for(let i=0;i<this.setting.length;i++){let a=e.charAt(Math.floor(Math.random()*t));n+=a}return n}shuffle(e){return e.split("").sort((n,t)=>Math.random()-.5).join("")}}const v={class:"row mb-2"},R={class:"col-12 input-group"},U=["disabled"],G=["disabled"],L=s("i",{class:"fa-solid fa-xmark"},null,-1),N=[L],y=["disabled"],f=s("i",{class:"fa-solid fa-copy"},null,-1),I=[f],D={class:"row mb-2"},F={class:"col-12"},w={class:"card"};const M={class:"card-body"},x={key:0,class:"col-12"},k={class:"col-12 input-group mb-2"},B=s("span",{class:"input-group-text"},"Length",-1),O=["onUpdate:modelValue"],P={class:"col-12"},H=["onUpdate:modelValue","min","max","step"],X={key:1,class:"col-8"},$=["onClick"],V=["textContent"],j={class:"col"},W=["textContent"],z={mixins:[C],data(){return{password:"",settings:{length:{value:8,min:1,max:256,step:1,type:"number"},lowercase:{value:!0,label:"Lower case",description:"a-z",type:"boolean"},uppercase:{value:!0,label:"Upper case",description:"A-Z",type:"boolean"},numbers:{value:!0,label:"Number",description:"0-9",type:"boolean"},special_characters:{value:!0,label:"Special Characters",description:"#!”$%&’",type:"boolean"},avoid_ambiguous_characters:{value:!0,label:"Avoid Ambiguous Character",description:"lI|",type:"boolean"}}}},computed:{disabled_generate(){return this.settings.length.value.length==0?!0:parseInt(this.settings.length.value)<=0||!this.settings.lowercase.value&&!this.settings.uppercase.value&&!this.settings.numbers.value&&!this.settings.special_characters.value}},methods:{async init(){this.password_generator=new S},generate(){this.password=this.password_generator.generate({length:this.settings.length.value,lowercase:this.settings.lowercase.value,uppercase:this.settings.uppercase.value,numbers:this.settings.numbers.value,special:this.settings.special_characters.value,avoidAmbiguous:this.settings.avoid_ambiguous_characters.value})}},created(){this.init()}},J=E({...z,__name:"PasswordGenerator",setup(h){return(e,n)=>(l(),p(b,null,{default:g(()=>[s("div",v,[s("div",R,[s("button",{type:"button",class:"btn btn-primary rounded-start-pill",onClick:n[0]||(n[0]=(...t)=>e.generate&&e.generate(...t)),disabled:e.disabled_generate}," Generate: ",8,U),r(s("input",{type:"text",class:"form-control text-center text-primary","onUpdate:modelValue":n[1]||(n[1]=t=>e.password=t),maxlength:"256"},null,512),[[u,e.password]]),s("button",{type:"button",class:"btn btn-outline-secondary",onClick:n[2]||(n[2]=t=>e.password=""),disabled:e.password.length===0},N,8,G),s("button",{type:"button",class:"btn btn-outline-primary",onClick:n[3]||(n[3]=t=>e.copyToClipboard(e.password)),disabled:e.password.length===0},I,8,y)])]),s("div",D,[s("div",F,[s("div",w,[c("",!0),s("div",M,[(l(!0),o(m,null,T(e.settings,(t,i)=>(l(),o("div",{class:"row mb-2",key:i},[t.type==="number"?(l(),o("div",x,[s("div",k,[B,r(s("input",{type:"number",class:"form-control",readonly:"","onUpdate:modelValue":a=>t.value=a},null,8,O),[[u,t.value]])]),s("div",P,[r(s("input",{type:"range",class:"form-range","onUpdate:modelValue":a=>t.value=a,min:t.min??1,max:t.max??256,step:t.step??1},null,8,H),[[u,t.value]])])])):c("",!0),t.type==="boolean"?(l(),o("div",X,[s("div",{class:A(`btn rounded-pill d-grid
                                            ${t.value?"btn-outline-primary":"btn-outline-secondary"}
                                        `),onClick:a=>t.value=!t.value},[s("span",{textContent:d(t.label)},null,8,V)],10,$)])):c("",!0),s("div",j,[s("span",{class:"",textContent:d(t.description)},null,8,W)])]))),128))])])])])]),_:1}))}});export{J as default};
